<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <script src="../bower_components/webcomponentsjs/webcomponents.min.js"></script>
    <script src="../bower_components/web-component-tester/browser.js"></script>
    <link rel="import" href="../src/vertx-eventbus.html">
</head>
<body>
<vertx-eventbus id="eventBus" url="http://localhost:8090"></vertx-eventbus>
<script>
    var eventBus = document.getElementById('eventBus');

    console.log(eventBus);

    suite('<vertx-eventbus>', function() {

      setup(function(){
        console.log('setup!!!!');
      });

      teardown(function(){
        console.log('teardown!!!!');
      });

      test('should have url attribute', function() {
        expect(eventBus.url).to.equal('http://localhost:8090');
      });

      test('should close the connection after calling close()', function(done) {
        eventBus.addEventListener('open', function() {
          done();
          eventBus.close();
          expect(eventBus.isConnected).to.equal(false);
        });
      });

      test('should fire open event after accessing to vertx backend successfully', function(done) {
        eventBus.addEventListener('open', function() {
          expect(eventBus.isConnected).to.equal(true);
          done();
        });
      });
    });
</script>
</body>
</html>